instrumentos = []
unidades = []

while True:
    print("\nMenú:")
    print("1. Ingresar instrumentos")
    print("2. Ingresar unidades disponibles")
    print("3. Mostrar inventario")
    print("4. Consultar unidades por instrumento")
    print("5. Listar faltantes (0)")
    print("6. Agregar instrumento")
    print("7. Ver faltantes")
    print("8. Actualizar unidades (disminuir/aumentar)")
    print("9. Ver inventario completo")
    print("10. Salir")

    opcion = input("Seleccione una opción: ").strip()

    match opcion:
        case '1':
            cant = input("¿Cuántos instrumentos desea ingresar? ").strip()
            if not cant.isdigit():
                print("ERROR: Debe ingresar un número.")
                continue
            cant = int(cant)
            for i in range(cant):
                nombre = input(f"Ingrese nombre del instrumento #{i+1}: ").strip()
                if nombre == "":
                    print("ERROR: El nombre no puede estar vacío.")
                    continue
                nombre = nombre.title()
                if nombre in instrumentos:
                    print("ERROR: Ese instrumento ya existe.")
                    continue
                instrumentos.append(nombre)
                unidades.append(0)
                print(f"OK: {nombre} agregado con 0 unidades.")

        case '2':
            if not instrumentos:
                print("No hay instrumentos para asignar unidades. Use opción 1 o 6.")
                continue
            for i in range(len(instrumentos)):
                valor = input(f"Unidades para '{instrumentos[i]}': ").strip()
                if not valor.isdigit():
                    print("ERROR: Debe ingresar un número entero >= 0. Se cancela la carga.")
                    break
                valor = int(valor)
                unidades[i] = valor
            else:
                print("Unidades actualizadas.")

        case '3':
            if not instrumentos:
                print("No hay instrumentos cargados.")
                continue
            for i in range(len(instrumentos)):
                print(f"{instrumentos[i]}: {unidades[i]} unidades")

        case '4':
            if not instrumentos:
                print("No hay instrumentos cargados.")
                continue
            nombre = input("Nombre del instrumento: ").strip().title()
            if nombre not in instrumentos:
                print("Ese instrumento no existe.")
            else:
                idx = instrumentos.index(nombre)
                print(f"{nombre}: {unidades[idx]} unidades disponibles")

        case '5':
            if not instrumentos:
                print("No hay instrumentos cargados.")
                continue
            hay = False
            for i in range(len(instrumentos)):
                if unidades[i] == 0:
                    print(f"- {instrumentos[i]}")
                    hay = True
            if not hay:
                print("Ninguno.")

        case '6':
            nombre = input("Nombre del nuevo instrumento: ").strip()
            if nombre == "":
                print("ERROR: El nombre no puede estar vacío.")
                continue
            nombre = nombre.title()
            if nombre in instrumentos:
                print("ERROR: Ese instrumento ya existe.")
                continue
            cant = input(f"Unidades iniciales para '{nombre}': ").strip()
            if not cant.isdigit():
                print("ERROR: Debe ingresar un número entero >= 0.")
                continue
            cant = int(cant)
            instrumentos.append(nombre)
            unidades.append(cant)
            print(f"OK: {nombre} agregado con {cant} unidades.")

        case '7':
            if not instrumentos:
                print("No hay instrumentos cargados.")
                continue
            hay = False
            for i in range(len(instrumentos)):
                if unidades[i] == 0:
                    print(f"- {instrumentos[i]}")
                    hay = True
            if not hay:
                print("Ninguno.")

        case '8':
            if not instrumentos:
                print("No hay instrumentos cargados.")
                continue
            nombre = input("Instrumento a actualizar (disminuir/aumentar): ").strip().title()
            if nombre not in instrumentos:
                print("Ese instrumento no existe.")
                continue
            idx = instrumentos.index(nombre)
            print(f"Stock actual de '{nombre}': {unidades[idx]} unidades")
            modo = input("Ingrese 'd' para disminuir o 'a' para aumentar: ").strip().lower()
            if modo == 'd':
                cant = input("¿Cuántas unidades desea disminuir? ").strip()
                if not cant.isdigit():
                    print("ERROR: Debe ingresar un número entero > 0.")
                    continue
                cant = int(cant)
                if cant <= 0:
                    print("ERROR: Debe ser mayor que 0.")
                    continue
                if cant > unidades[idx]:
                    print("ERROR: No puede disminuir más de las disponibles.")
                    continue
                unidades[idx] -= cant
                print(f"Actualizado. Nuevo stock: {unidades[idx]}")
            elif modo == 'a':
                cant = input("¿Cuántas unidades desea aumentar? ").strip()
                if not cant.isdigit():
                    print("ERROR: Debe ingresar un número entero > 0.")
                    continue
                cant = int(cant)
                if cant <= 0:
                    print("ERROR: Debe ser mayor que 0.")
                    continue
                unidades[idx] += cant
                print(f"Actualizado. Nuevo stock: {unidades[idx]}")
            else:
                print("Opción inválida. Use 'd' o 'a'.")

        case '9':
            if not instrumentos:
                print("No hay instrumentos cargados.")
                continue
            for i in range(len(instrumentos)):
                print(f"{instrumentos[i]}: {unidades[i]} unidades")

        case '10':
            print("Hasta luego.")
            break

        case _: